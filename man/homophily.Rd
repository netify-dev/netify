% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/homophily.R
\name{homophily}
\alias{homophily}
\title{Analyze homophily in network data}
\usage{
homophily(
  netlet,
  attribute,
  method = "correlation",
  threshold = 0,
  significance_test = TRUE,
  n_permutations = 1000,
  alpha = 0.05,
  other_stats = NULL,
  ...
)
}
\arguments{
\item{netlet}{A netify object containing network data.}

\item{attribute}{Character string specifying the nodal attribute to analyze.}

\item{method}{Character string specifying the similarity metric:
\describe{
\item{"correlation"}{Negative absolute difference for continuous data (default)}
\item{"euclidean"}{Negative euclidean distance for continuous data}
\item{"manhattan"}{Negative Manhattan/city-block distance for continuous data}
\item{"cosine"}{Cosine similarity for continuous data}
\item{"categorical"}{Binary similarity (0/1) for categorical data}
\item{"jaccard"}{Jaccard similarity for binary/presence-absence data}
\item{"hamming"}{Negative Hamming distance for categorical data}
}}

\item{threshold}{Numeric value or function to determine tie presence in weighted networks.
If numeric, edges with weights > threshold are considered ties. If a function,
it should take the network matrix and return a logical matrix. Default is 0
(any positive weight is a tie). Common values: 0 (default), mean(weights),
median(weights), or quantile-based thresholds. For pre-binarized networks,
consider using \code{transform_weights()} first.}

\item{significance_test}{Logical. Whether to perform permutation test. Default TRUE.}

\item{n_permutations}{Number of permutations for significance testing. Default 1000.}

\item{alpha}{Significance level for confidence intervals. Default 0.05.}

\item{other_stats}{Named list of custom functions for additional statistics.}

\item{...}{Additional arguments passed to custom functions.}
}
\value{
Data frame with homophily statistics per network/time period:
\describe{
\item{\code{net}}{Network/time identifier}
\item{\code{layer}}{Layer name}
\item{\code{attribute}}{Analyzed attribute name}
\item{\code{method}}{Similarity method used}
\item{\code{threshold_value}}{Threshold used for determining ties (NA for binary networks)}
\item{\code{homophily_correlation}}{Correlation between similarity and tie presence (binary: tie/no tie)}
\item{\code{mean_similarity_connected}}{Mean similarity among connected pairs (weight > threshold)}
\item{\code{mean_similarity_unconnected}}{Mean similarity among unconnected pairs (weight <= threshold or missing)}
\item{\code{similarity_difference}}{Difference between connected and unconnected mean similarities}
\item{\code{p_value}}{Permutation test p-value}
\item{\code{ci_lower}, \code{ci_upper}}{Confidence interval bounds}
\item{\code{n_connected_pairs}}{Number of connected pairs}
\item{\code{n_unconnected_pairs}}{Number of unconnected pairs}
}
}
\description{
Tests whether connected actors have similar attributes (homophily). Calculates
the correlation between attribute similarity and tie presence, with support for
multiple similarity metrics and significance testing.
}
\details{
\strong{Similarity Metrics:}

For continuous attributes:
\itemize{
\item \code{correlation}: Based on absolute difference, good general purpose metric
\item \code{euclidean}: Similar to correlation for single attributes
\item \code{manhattan}: Less sensitive to outliers than euclidean
\item \code{cosine}: Useful for normalized data or when sign matters
}

For categorical/binary attributes:
\itemize{
\item \code{categorical}: Simple matching (1 if same, 0 if different)
\item \code{jaccard}: For binary data, emphasizes shared presence over shared absence
\item \code{hamming}: Counts positions where values differ (negated for similarity)
}

\strong{Threshold Parameter:}

For weighted networks, the \code{threshold} parameter determines what edge weights
constitute a "connection". You can specify:
\itemize{
\item A numeric value: edges with weight > threshold are ties
\item A function: should take a matrix and return a single numeric threshold
\item Common threshold functions:
\itemize{
\item \code{function(x) mean(x, na.rm = TRUE)} - mean weight
\item \code{function(x) median(x, na.rm = TRUE)} - median weight
\item \code{function(x) quantile(x, 0.75, na.rm = TRUE)} - 75th percentile
}
}

For more complex binarization needs (e.g., different thresholds by time period),
consider using \code{transform_weights()} to pre-process your network.
}
\examples{
\dontrun{
# Basic homophily analysis with default threshold (> 0)
homophily_default <- homophily(net, attribute = "group")

# Using different similarity metrics for continuous data
homophily_manhattan <- homophily(
  net, 
  attribute = "age",
  method = "manhattan"  # Less sensitive to outliers
)

# For binary attributes (e.g., gender, membership)
homophily_jaccard <- homophily(
  net,
  attribute = "member", 
  method = "jaccard"  # Better for binary data than correlation
)

# For categorical attributes
homophily_categorical <- homophily(
  net,
  attribute = "department",
  method = "categorical"
)

# Combining method and threshold
homophily_combined <- homophily(
  net,
  attribute = "score",
  method = "manhattan",
  threshold = function(x) quantile(x, 0.75, na.rm = TRUE)
)
}

}
